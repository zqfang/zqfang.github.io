<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Bayesian Data Analysis: Basics - My Computational Genomic Playground</title><meta name=Description content="Bayesian Data Analysis Notes"><meta property="og:title" content="Bayesian Data Analysis: Basics"><meta property="og:description" content="Bayesian Data Analysis Notes"><meta property="og:type" content="article"><meta property="og:url" content="https://zqfang.github.io/2022-08-10-bda1/"><meta property="og:image" content="https://zqfang.github.io/logo.png"><meta property="article:published_time" content="2022-02-10T00:00:00+00:00"><meta property="article:modified_time" content="2022-02-10T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zqfang.github.io/logo.png"><meta name=twitter:title content="Bayesian Data Analysis: Basics"><meta name=twitter:description content="Bayesian Data Analysis Notes"><meta name=application-name content="Pleiades"><meta name=apple-mobile-web-app-title content="Pleiades"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://zqfang.github.io/2022-08-10-bda1/><link rel=prev href=https://zqfang.github.io/2022-02-16-rust-basics/><link rel=next href=https://zqfang.github.io/2020-04-28-seurat2scanpy/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.1e2694bed152fa2922dbe909a441838ed693d88b1330f97485bfa8ed78da42df.css integrity="sha256-HiaUvtFS+iki2+kJpEGDjtaT2IsTMPl0hb+o7XjaQt8="><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Bayesian Data Analysis: Basics","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/zqfang.github.io\/2022-08-10-bda1\/"},"image":["https:\/\/zqfang.github.io\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"Bayesian Data Analysis","wordcount":953,"url":"https:\/\/zqfang.github.io\/2022-08-10-bda1\/","datePublished":"2022-02-10T00:00:00+00:00","dateModified":"2022-02-10T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/zqfang.github.io\/images\/avatar.png"},"author":{"@type":"Person","name":"zqfang"},"description":"Bayesian Data Analysis Notes"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My Computational Genomic Playground"><span class=header-title-pre><span>&#8711;</span></span>Pleiades <span class=header-title-post><i class="fas fa-terminal"></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/publication/>Publication </a><a class=menu-item href=/portfolio/>Portfolio </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/ title=About>About </a><a class=menu-item href=https://github.com/zqfang title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My Computational Genomic Playground"><span class=header-title-pre><span>&#8711;</span></span>Pleiades <span class=header-title-post><i class="fas fa-terminal"></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/categories/>Categories</a><a class=menu-item href=/publication/>Publication</a><a class=menu-item href=/portfolio/>Portfolio</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/about/ title=About>About</a><a class=menu-item href=https://github.com/zqfang title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Bayesian Data Analysis: Basics</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>zqfang</a></span>&nbsp;<span class=post-category>included in <a href=/categories/statistic/><i class="far fa-folder fa-fw"></i>Statistic</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-10>2022-02-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;953 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#means-and-variances-of-conditional-distributions>Means and variances of conditional distributions</a></li></ul><ul><li><a href=#sampling-using-the-inverse-cumulative-distribution-function>Sampling using the inverse cumulative distribution function</a></li><li><a href=#simulation-of-posterior-and-posterior-predictive-quantities>Simulation of posterior and posterior predictive quantities</a></li></ul></nav></div></div><div class=content id=content><h1 id=the-three-steps-of-bayesian-data-analysis>The three steps of Bayesian data analysis</h1><ol><li><p>Setting up a <code>full probability model</code>—a joint probability distribution for all observable and unobservable quantities in a problem.</p></li><li><p>Conditioning on observed data: calculating and interpreting the appropriate <code>posterior distribution</code>—the conditional probability distribution of the unobserved quantities of ultimate interest, given the observed data.</p></li><li><p>Evaluating the ﬁt of the model and the implications of the resulting posterior distribution.</p></li></ol><h1 id=bayes-rule>Bayes&rsquo; rule</h1><p>$$ p (\theta, y) = p(\theta)p(y | \theta)$$</p><ul><li>$p (\theta, y)$: joint probability distribution for $\theta$ and $y$ .</li><li>$p (\theta)$: prior distribution</li><li>$p (\theta | y)$: sampling distritbuion (data distitbution).</li></ul><h1 id=bayesian-inference>Bayesian Inference</h1><p>Simply conditioning on the known value of the data $y$, using the basic property of conditional probability known as Bayes&rsquo;s rule, yields the posterior density:</p><p>$$
p(\theta \mid y)=\frac{p(\theta, y)}{p(y)}=\frac{p(\theta) p(y \mid \theta)}{p(y)}
$$</p><p>where $p (y) = \sum_{\theta} p(\theta) p(y \mid \theta)$ , and the sum is over all possible values of $\theta$. or $p(y) = \int p(\theta) p(y \mid \theta) d \theta$.</p><p>$p(y)$ is fixed, thus can be considered a constant, yielding the <code>unnormalized posterior density</code> :</p><p>$$
p(\theta \mid y) \propto p(\theta) p(y \mid \theta)
$$</p><h1 id=prediction>Prediction</h1><p>To make inferences about an unknown observable, often valled predictive inferences.</p><p>The distribution of the unknown but observablle $y$ is</p><p>$$
p(y) = \int p(y, \theta) d \theta = \int p(\theta) p (y \mid \theta) d \theta
$$</p><p>This is often called the <code>marginal distibution</code> of $y$, but a more informative name is the <code>prior predictive distritbuition</code>.</p><p>prior because it is not conditional on a previous observvation of the process, and predictive because it is the distribution for a quantity that is observable.</p><p>$\tilde{y}$ : <code>posterior predictive distribution</code>. posterior because it is conditional on the observed $y$ and predictive because it is a prediction for an observable $\tilde{y}$.</p><p>$$
\begin{aligned}
p(\tilde{y} \mid y) &=\int p(\tilde{y}, \theta \mid y) d \theta \\
&=\int p(\tilde{y} \mid \theta, y) p(\theta \mid y) d \theta \\
&=\int p(\tilde{y} \mid \theta) p(\theta \mid y) d \theta
\end{aligned}
$$</p><h1 id=likelihood-and-odds-ratios>Likelihood and odds ratios</h1><p>Using Bayes’ rule with a chosen probability model means that the data $y$ affect the posterior inference only through $p(y| \theta$, which, when regarded as a function of θ, for fixed $y$, is called the <code>likelihood function</code>. In this way Bayesian inference is obeying what is sometimes called the <code>likelihood principle</code>.</p><p>the ratio of the posterior density $p(\theta \mid y)$ evaluated at the points $\theta_1$ and $\theta_2$ under a given model is called the <code>posterior odds</code> for $\theta_1$ compared to $\theta_2$</p><p>$$
\frac{p\left(\theta_{1} \mid y\right)}{p\left(\theta_{2} \mid y\right)}=\frac{p\left(\theta_{1}\right) p\left(y \mid \theta_{1}\right) / p(y)}{p\left(\theta_{2}\right) p\left(y \mid \theta_{2}\right) / p(y)}=\frac{p\left(\theta_{1}\right)}{p\left(\theta_{2}\right)} \frac{p\left(y \mid \theta_{1}\right)}{p\left(y \mid \theta_{2}\right)}
$$</p><p>the posterior odds are equal to the prior odds multiplied byu the likelihood ratio.</p><h1 id=probability>Probability</h1><p>the mathmatical definition of probabilty: probablities are numerical quantities, defined on a set of &ldquo;outcomes&rdquo;, that are non-negative, additive over mutually exclusive outcomes, and sum to 1 over all possible mutally exclusive outcomes.</p><p>In Bayesian statistics, probability is used as the fundamental measure or yardstick of uncertainty.</p><h2 id=means-and-variances-of-conditional-distributions>Means and variances of conditional distributions</h2><p>mean and variance:</p><p>$$
\mathrm{E}(u)=\int u p(u) d u, \quad \operatorname{var}(u)=\int(u-\mathrm{E}(u))^{2} p(u) d u
$$</p><p>variance matrix (covariance matrix)</p><p>$$
\operatorname{var}(u)=\int(u-\mathrm{E}(u))(u-\mathrm{E}(u))^{T} p(u) d u
$$</p><p>The mean of $u$ can be obtained by averaging the conditional mean over the marginal distributionof $v$.</p><p>$$
\mathrm{E}(u)= \mathrm{E}(\mathrm{E}( u \mid v))
$$</p><p>and variance</p><p>$$
\operatorname{var}(u)=\mathrm{E}(\operatorname{var}(u \mid v))+\operatorname{var}(\mathrm{E}(u \mid v))
$$</p><h1 id=summarizing-inference-by-simulation>Summarizing inference by simulation</h1><ol><li><p>Simulation forms a central part of much applied Bayesian analysis, because of the relative ease with which samples can often be generated from a probability distribution, even when the density function cannot be explicitly integrated.</p></li><li><p>Another advantage of simulation is that extremely large or small simulated values often ﬂag a problem with model speciﬁcation or parameterization that might not be noticed if estimates and probability statements were obtained in analytic form</p></li><li><p>Generating values from a probability distribution is often straightforward with modern computing techniques based on (pseudo)random number sequences.</p></li></ol><h2 id=sampling-using-the-inverse-cumulative-distribution-function>Sampling using the inverse cumulative distribution function</h2><p>A method for sampling from discrete and continuous distributuions using the <code>cumalative distribution function</code> or <code>cdf</code>, $F$, of a one-dimensional distribution, $p(v)$, is defined by</p><p>$$
\begin{aligned}
F\left(v_{*}\right) &=\operatorname{Pr}\left(v \leq v_{*}\right) \\
&= \begin{cases}\sum_{v \leq v_{*}} p(v) & \text { if } p \text { is discrete } \\
\int_{-\infty}^{v_{*}} p(v) d v & \text { if } p \text { is continuous. }\end{cases}
\end{aligned}
$$</p><p>The inverse cdf can be used to obtain random samples from the distribution p, as follows:</p><ol><li>Draw a random value, $U$, from the <code>uniform distribution</code> on [0, 1], using a table of random numbers. Let $v = F^{-1} (U)$.</li><li>The value $v$ will be a random draw from $p$,</li></ol><h2 id=simulation-of-posterior-and-posterior-predictive-quantities>Simulation of posterior and posterior predictive quantities</h2><p>In practice, we are most often interested in simulating draws from the posterior distribution of the model parameters $\theta$, and perhaps from the posterior predictive distribution of unknown observables $\tilde{y}$.</p><p>Results from a set of $S$ simulation draws can be stored in the computer in an array, e.g.</p><p>$$
\begin{array}{ccccccc}
\begin{array}{c}
\text { Simulation } \\
\text { draw }
\end{array} & \multicolumn{2}{c}{\text { Parameters }} & \multicolumn{3}{c}{\text { Predictive }} \\
& \theta_{1} & \ldots & \theta_{k} & \tilde{y}_{1} & \ldots & \tilde{y}_{n} \\
\hline 1 & \theta_{1}^{1} & \ldots & \theta_{k}^{1} & \tilde{y}_{1}^{1} & \ldots & \tilde{y}_{n}^{1} \\
\vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
\mathrm{S} & \theta_{1}^{S} & \ldots & \theta_{k}^{S} & \tilde{y}_{1}^{S} & \ldots & \tilde{y}_{n}^{S}
\end{array}
$$</p><p>From these simulated values, we can estimate the posterior distribution of any quantity of interest, such as $\theta_1 / \theta_2$. We can estimate the posterior probability of any event, such as $Pr (\tilde{y}_1 + \tilde{y}_2) > e^{\theta_1}$</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-02-10</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://zqfang.github.io/2022-08-10-bda1/ data-title="Bayesian Data Analysis: Basics" data-hashtags="Bayesian Data Analysis"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://zqfang.github.io/2022-08-10-bda1/ data-hashtag="Bayesian Data Analysis"><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://zqfang.github.io/2022-08-10-bda1/ data-title="Bayesian Data Analysis: Basics"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://zqfang.github.io/2022-08-10-bda1/ data-title="Bayesian Data Analysis: Basics"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://zqfang.github.io/2022-08-10-bda1/ data-title="Bayesian Data Analysis: Basics"><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/bayesian-data-analysis/>Bayesian Data Analysis</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022-02-16-rust-basics/ class=prev rel=prev title="Rust: Advanced Trait"><i class="fas fa-angle-left fa-fw"></i>Rust: Advanced Trait</a>
<a href=/2020-04-28-seurat2scanpy/ class=next rel=next title="Convert Seurat to Scanpy h5ad">Convert Seurat to Scanpy h5ad<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>zqfang</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css><script type=text/javascript src=https://bioninja-1.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type=text/javascript src=/js/theme.min.f51938f3065a40ee841bcb558e4330e31fd26c0ea55343fff8770b88b0319a3c.js integrity="sha256-9Rk48wZaQO6EG8tVjkMw4x/SbA6lU0P/+HcLiLAxmjw="></script></body></html>