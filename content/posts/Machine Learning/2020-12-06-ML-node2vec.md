---
title: "Graph Embeding: Node2Vec"
date: 2020-12-06
categories: ["Nature Language Processing"]
comments: true
tags: ["Deep Learning", "Graph"]
math: true
---

Node Embedings are learnt in the same way as `word2vec` (skip-gram model)

However, graphs could be (un)directed, (un)weighted, (a)cyclic and are basically much more complex than the strucure of a sequence...

So how do we generate "corpus" from a graph ?

## Sampling strategy

![node2vec2](/images/ml/node2vec2.png)

Node2vec's sampling strategy accepts 4 argument:
- **Number of walks**: number of random walks to be generated from each node in the graph
- **Walk length**: how many nodes are in each random walk
- **P**: return hyperparameter
- **Q**: Inout hyperparameter (DFS biased or BFS baised control)

Also, the standard skip-gram parameters
- context window size
- number of iterations
- etc.

### Principal

![node2vec1](/images/ml/node2vec1.png)

Consider you are on the random walk, and have just transitioned from node $t$ to node $v$ in the above diagram

the probability to transition from $v$ to any neighbors is edge $\alpha$, where $\alpha$ is depened on the hyperparameters. 

- $\bold{P}$: controls the probability to go back to $t$ after visiting $v$
- $\bold{Q}$: controls the probability to go explore undiscovered parts of the graphs.

So, the final travel probability is a function of 

$$
\alpha_{p q}(t, x)=\begin{cases} 
\frac{1}{p} & \text { if } d_{t x}=0 \cr 
1 & \text { if } d_{t x}=1 \cr 
\frac{1}{q} & \text { if } d_{t x}=2
\end{cases}
$$

where,
- $d_{tx}$: the length of shortest path of $t$ and $v$.
  - 0: $x$ is $t$
  - 1: $x$ is neighbor to $t$
  - 2: $x$ and $t$ not connected  

Using the sampling strategy, node2vec will generate "senences" (the directed subgraphs) which are will be used for embedding just like text sentences are used in word2vec.

## Reference

[node2vec: Scalable Feature Learning for Networks](https://cs.stanford.edu/~jure/pubs/node2vec-kdd16.pdf)  
[Embeddings for Graph Data](https://towardsdatascience.com/node2vec-embeddings-for-graph-data-32a866340fef)